<!-- Overview Stats -->
<div class="grid md:grid-cols-3 gap-6 mb-8">
  <div class="bg-blue-50 rounded-lg p-6 text-center border-l-4 border-blue-600">
    <div class="text-4xl font-bold text-blue-600 mb-2">{{ stats.overview.total_files }}</div>
    <div class="text-gray-700 font-semibold">Total Files</div>
  </div>
  <div class="bg-green-50 rounded-lg p-6 text-center border-l-4 border-green-600">
    <div class="text-4xl font-bold text-green-600 mb-2">{{ stats.overview.total_cases }}</div>
    <div class="text-gray-700 font-semibold">Total Cases</div>
  </div>
  <div class="bg-purple-50 rounded-lg p-6 text-center border-l-4 border-purple-600">
    <div class="text-4xl font-bold text-purple-600 mb-2">{{ stats.overview.total_size_gb }} GB</div>
    <div class="text-gray-700 font-semibold">Total Size</div>
  </div>
</div>

<!-- File Types Distribution -->
{% if stats.file_types %}
<div class="mb-8">
  <h4 class="text-xl font-bold mb-4 text-gray-900">File Types Distribution</h4>
  <div class="bg-white rounded-lg shadow-lg p-6">
    <div class="space-y-3">
      {% for file_type in stats.file_types %}
      <div class="flex items-center">
        <div class="flex-1">
          <div class="flex justify-between items-center mb-1">
            <span class="font-semibold text-gray-800">{{ file_type.name }}</span>
            <span class="text-sm text-gray-600">{{ file_type.count }} files ({{ file_type.percentage }}%)</span>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-2">
            <div class="bg-blue-600 h-2 rounded-full" style="width: {{ file_type.percentage }}%"></div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endif %}

<!-- Case Statistics -->
{% if stats.case_statistics %}
<div class="mb-8">
  <h4 class="text-xl font-bold mb-4 text-gray-900">Case Statistics</h4>

  <div class="grid md:grid-cols-2 gap-6 mb-6">
    <!-- Files per Case Distribution -->
    <div class="bg-white rounded-lg shadow-lg p-6">
      <h5 class="text-lg font-semibold mb-4 text-gray-800">Files per Case</h5>
      <div class="grid grid-cols-3 gap-4 mb-4">
        <div class="text-center">
          <div class="text-2xl font-bold text-blue-600">{{ stats.case_statistics.files_per_case.min }}</div>
          <div class="text-xs text-gray-600">Min</div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-green-600">{{ stats.case_statistics.files_per_case.avg }}</div>
          <div class="text-xs text-gray-600">Avg</div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-purple-600">{{ stats.case_statistics.files_per_case.max }}</div>
          <div class="text-xs text-gray-600">Max</div>
        </div>
      </div>
      {% if stats.case_statistics.files_per_case.distribution %}
      <div class="space-y-2 mt-4">
        <div class="text-sm font-semibold text-gray-700 mb-2">Distribution:</div>
        {% for bucket in stats.case_statistics.files_per_case.distribution|slice:":10" %}
        <div class="flex items-center text-sm">
          <span class="w-24 text-gray-700">{{ bucket.file_count }} file{% if bucket.file_count != 1 %}s{% endif %}:</span>
          <div class="flex-1 ml-2">
            <div class="flex items-center">
              <div class="flex-1 bg-gray-200 rounded-full h-1.5">
                <div class="bg-indigo-600 h-1.5 rounded-full" style="width: {{ bucket.percentage }}%"></div>
              </div>
              <span class="ml-2 text-xs text-gray-600 w-20">{{ bucket.case_count }} cases</span>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
      {% endif %}
    </div>

    <!-- Cases per Contributor -->
    {% if stats.case_statistics.cases_per_contributor %}
    <div class="bg-white rounded-lg shadow-lg p-6">
      <h5 class="text-lg font-semibold mb-4 text-gray-800">Cases per Contributor</h5>
      <div class="space-y-2">
        {% for contrib in stats.case_statistics.cases_per_contributor %}
        <div class="border-b border-gray-200 pb-2 last:border-0">
          <div class="flex justify-between items-center mb-1">
            <span class="text-sm font-medium text-gray-800 truncate flex-1">{{ contrib.contributor }}</span>
            <span class="text-xs text-gray-600 ml-2 whitespace-nowrap">{{ contrib.case_count }} cases</span>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-1.5">
            <div class="bg-green-600 h-1.5 rounded-full" style="width: {{ contrib.percentage }}%"></div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>
</div>
{% endif %}

<!-- Terminology Distribution -->
<div class="grid md:grid-cols-3 gap-6 mb-8">
  <!-- Disease Distribution -->
  {% if stats.terminology.disease %}
  <div>
    <h4 class="text-lg font-bold mb-4 text-gray-900">Disease Distribution</h4>
    <div class="bg-white rounded-lg shadow-lg p-4">
      <div class="space-y-2">
        {% for disease in stats.terminology.disease|slice:":5" %}
        <div class="border-b border-gray-200 pb-2 last:border-0">
          <div class="flex justify-between items-start">
            <span class="text-sm font-medium text-gray-800">{{ disease.name }}</span>
            <span class="text-xs text-gray-600 ml-2">{{ disease.file_count }} cases</span>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-1.5 mt-1">
            <div class="bg-red-500 h-1.5 rounded-full" style="width: {{ disease.percentage }}%"></div>
          </div>
        </div>
        {% endfor %}
        {% if stats.terminology.disease|length > 5 %}
        <div class="text-xs text-gray-500 text-center pt-2">
          +{{ stats.terminology.disease|length|add:"-5" }} more
        </div>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Tissue Distribution -->
  {% if stats.terminology.tissue %}
  <div>
    <h4 class="text-lg font-bold mb-4 text-gray-900">Tissue Distribution</h4>
    <div class="bg-white rounded-lg shadow-lg p-4">
      <div class="space-y-2">
        {% for tissue in stats.terminology.tissue|slice:":5" %}
        <div class="border-b border-gray-200 pb-2 last:border-0">
          <div class="flex justify-between items-start">
            <span class="text-sm font-medium text-gray-800">{{ tissue.name }}</span>
            <span class="text-xs text-gray-600 ml-2">{{ tissue.file_count }} cases</span>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-1.5 mt-1">
            <div class="bg-green-500 h-1.5 rounded-full" style="width: {{ tissue.percentage }}%"></div>
          </div>
        </div>
        {% endfor %}
        {% if stats.terminology.tissue|length > 5 %}
        <div class="text-xs text-gray-500 text-center pt-2">
          +{{ stats.terminology.tissue|length|add:"-5" }} more
        </div>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Biomarker Distribution -->
  {% if stats.terminology.biomarkers %}
  <div>
    <h4 class="text-lg font-bold mb-4 text-gray-900">Biomarker Distribution</h4>
    <div class="bg-white rounded-lg shadow-lg p-4">
      <div class="space-y-2">
        {% for biomarker in stats.terminology.biomarkers|slice:":5" %}
        <div class="border-b border-gray-200 pb-2 last:border-0">
          <div class="flex justify-between items-start">
            <span class="text-sm font-medium text-gray-800">{{ biomarker.name }}</span>
            <span class="text-xs text-gray-600 ml-2">{{ biomarker.file_count }} cases</span>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-1.5 mt-1">
            <div class="bg-purple-500 h-1.5 rounded-full" style="width: {{ biomarker.percentage }}%"></div>
          </div>
        </div>
        {% endfor %}
        {% if stats.terminology.biomarkers|length > 5 %}
        <div class="text-xs text-gray-500 text-center pt-2">
          +{{ stats.terminology.biomarkers|length|add:"-5" }} more
        </div>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}
</div>

<!-- All Terms in Dataset -->
{% if stats.all_terms %}
<div class="mt-8">
  <h4 class="text-xl font-bold mb-4 text-gray-900">All Terms in Dataset</h4>
  <div class="bg-white rounded-lg shadow-lg p-6">
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-3">
      {% for term in stats.all_terms %}
      <div class="border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow">
        <div class="flex justify-between items-start">
          <span class="text-sm font-medium text-gray-800 flex-1">{{ term.name }}</span>
          <span class="text-lg font-bold text-blue-600 ml-2 whitespace-nowrap">{{ term.count }}</span>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endif %}

